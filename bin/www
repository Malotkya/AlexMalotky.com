#! /usr/bin/env node

let app = require('../app.js')
let express = require('express');

let http = express();
let https = require('https');
let fs = require('fs');


let port = process.env.PORT || "80";
let privateKey =  fs.readFileSync(__dirname + '/server.key', 'utf8');
let certificate = fs.readFileSync(__dirname + '/server.crt', 'utf8');

let server = https.createServer({
    key: privateKey,
    cert: certificate
}, app);

http.all("*", (req,res)=>res.redirect('https://' + req.headers.host + req.url));
http.listen(port);


server.listen(443, ()=> {
    `Application is listening on port ${port} and 443`;
});
